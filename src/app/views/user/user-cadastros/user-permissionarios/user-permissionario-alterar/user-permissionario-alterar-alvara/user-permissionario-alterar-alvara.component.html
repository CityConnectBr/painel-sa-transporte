<form *ngIf="!loading" [formGroup]="form" autocomplete="off">
  <div class="form-inline">

    <div class="subitem">
      <h3>Alvará
        <button type="submit" class="btn btn-new pull-right" (click)="openModal(novoAlvaraModal)" [disabled]="!form.valid">Criar
          Novo</button>
      </h3>

      <app-input label="Emissão">
        <input type="text" class="form-control" formControlName="data_emissao" mask="00/00/0000" [dropSpecialCharacters]="false"
          autocomplete="off">
      </app-input>

      <app-input label="Retorno">
        <input type="text" class="form-control" formControlName="data_retorno" mask="00/00/0000" [dropSpecialCharacters]="false"
          autocomplete="off">
      </app-input>

      <app-input label="Vencimento">
        <input type="text" class="form-control" formControlName="data_vencimento" mask="00/00/0000" [dropSpecialCharacters]="false"
          autocomplete="off">
      </app-input>

      <app-input label="Observação">
        <input type="text" class="form-control" formControlName="observacao_retorno" autocomplete="off">
      </app-input>
    </div>


    <button type="submit" class="btn btn-success pull-right" (click)="salvar(form.value)"
    [disabled]="!form.valid">Salvar</button>


    <div class="subitem">
      <h3>Alvarás Anteriores</h3>
      <table *ngIf="alvarasAnteriores.length>0" class="table table-striped">
        <thead>
          <tr>
            <th>Emissão</th>
            <th>Dt Retorno</th>
            <th>Dt Validade</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let obj of alvarasAnteriores">
            <td>{{obj?.data_emissao}}</td>
            <td>{{obj?.data_retorno}}</td>
            <td>{{obj?.data_vencimento}}</td>
          </tr>
        </tbody>
      </table>
      <div *ngIf="!alvarasAnteriores || alvarasAnteriores.length==0" class="alert alert-warning">
        Nenhum registro encontrado!
      </div>
    </div>

  </div>
  <div class="clearfix">
    <div class="alert alert-danger" *ngIf="errorMessage">
      <strong [innerHTML]="errorMessage"></strong>
    </div>
  </div>
</form>

<ng-template #novoAlvaraModal let-modal>
  <app-modal modalID="novoAlvaraModal" title="Novo Alvará" (closeModalEmit)="closeModal($event)">
    <div class="clearfix">
      <h6>Ao criar um novo alvará o atual está inválidado e mostrado no histórico.</h6><br>
      <h6>Deseja continuar?</h6>
      <button (click)="novo()" class="btn btn-danger btn-sm pull-right ml-1">Sim</button>
      <button (click)="closeModal($event)" class="btn btn-secondary btn-sm pull-right">Não</button>
    </div>
  </app-modal>
</ng-template>
